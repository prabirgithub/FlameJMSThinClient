<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Flame JMS Thin Client by prabirgithub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Flame JMS Thin Client</h1>
      <h2 class="project-tagline">One JMS client API for all popular message broker with zero configuration</h2>
      <a href="https://github.com/prabirgithub/JMSThinClient" class="btn">View on GitHub</a>
      <a href="https://github.com/prabirgithub/JMSThinClient/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/prabirgithub/JMSThinClient/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="what-is-flamjmsthinclient" class="anchor" href="#what-is-flamjmsthinclient" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What is FlamJMSThinClient?</h3>

<p>This is an JMS API built on top of Oracle JMS API. This API can be used by client who are consuming messaging services.
This API support all major/popular JMS vendors. This API need almost zero configuration to consume messages from any kind of message broker.</p>

<h3>
<a id="api-supports" class="anchor" href="#api-supports" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>API Supports</h3>

<p>
  Current release support JMS client API for HornetQ and ActiveMQ message broker.
  This API support Transactional and non-transactional messaging with message broker.
  This API automatically release resources used for messaging after completing.</p>

<h3>
<a id="api-supports" class="anchor" href="#api-supports" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example</h3>

<pre>
package org.flame.jms.client.test;

import static org.junit.Assert.*;

import javax.jms.ObjectMessage;

import org.flame.jms.client.helper.Credential;
import org.flame.jms.client.helper.IJmsMessageExecutor;
import org.flame.jms.client.helper.ITransaction;
import org.flame.jms.client.helper.JMSImplementation;
import org.flame.jms.client.remote.AbstractJmsMessageExecutor;
import org.flame.jms.client.remote.CorrelationIDGenerator;
import org.flame.jms.client.remote.IJmsConnectionConfiguration;
import org.flame.jms.client.remote.IJmsQueueConfiguration;
import org.flame.jms.client.remote.IMessageConnection;
import org.flame.jms.client.remote.IMessageSession;
import org.flame.jms.client.remote.JMSMessageProducer;
import org.flame.jms.client.remote.JmsTransportConfiguration;
import org.flame.jms.exceptions.FlameJMSClientException;
import org.flame.jms.exceptions.FlameMessageExecutionException;
import org.flame.jms.exceptions.FlameMessageFlowException;
//import org.apache.activemq.ActiveMQConnection;
import org.junit.After;
import org.junit.AfterClass;
import org.junit.Assert;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;

public class TestJmsClient {
	private static Credential credential = null;
	private static JmsTransportConfiguration transportConf = null;
	private static IJmsConnectionConfiguration connectionConf = null;
	private static IJmsQueueConfiguration queueConfig = null;
	@BeforeClass
	public static void setUpBeforeClass() throws Exception {
		String connUserName = "prabir";
		String connPassword = "prabir4@mj";
		
		credential = new Credential(connUserName, connPassword);
		transportConf = new JmsTransportConfiguration(JMSImplementation.HORNETQ,  "127.0.0.1", credential);
		connectionConf = transportConf.createConnectionConfiguration("jms/RemoteConnectionFactory", credential);
		queueConfig = transportConf.createQueueConfiguration("jms/queue/asyncInbound");
	}

	@AfterClass
	public static void tearDownAfterClass() throws Exception {
		transportConf.release();
	}

	@Before
	public void setUp() throws Exception {
	}

	@After
	public void tearDown() throws Exception {
	}

	//@Test
	public void testHornetQNonTransactional() {
		try {
			
			IJmsMessageExecutor<Void> executor = new AbstractJmsMessageExecutor<Void>(
					connectionConf, queueConfig) {

				public Void execute() throws FlameMessageFlowException {
					ObjectMessage objectMsg = createObjectMessage(new AppMessage());
					getProducer().send(objectMsg);
					return null;
				}
			};
			executor.run();
		} catch (Exception e) {
			e.printStackTrace();
			Assert.fail();
		}
	}
	
	@Test
	public void testHornetQTransactional() {
		try {
			
			boolean isTransactional = true;
			IJmsMessageExecutor<Void> executor = new AbstractJmsMessageExecutor<Void>(
					connectionConf, queueConfig, isTransactional) {

				public Void execute() throws FlameMessageFlowException {
					ObjectMessage objectMsg = createObjectMessage(new AppMessage());
					
					getProducer().send(objectMsg);
					return null;
				}
			};
			executor.run();
		} catch (FlameMessageExecutionException e) {
			e.printStackTrace();
			Assert.fail();
		}
	}
	
	//@Test
	public void testHornetQTransactionalWithBeginTrxn() {
		try {
			
			boolean isTransactional = true;
			IJmsMessageExecutor<Void> executor = new AbstractJmsMessageExecutor<Void>(
					connectionConf, queueConfig, isTransactional) {

				public Void execute() throws FlameMessageFlowException {
					ObjectMessage objectMsg = createObjectMessage(new AppMessage());
					ITransaction txn = beginTransaction();
					getProducer().send(objectMsg);
					txn.commit();
					return null;
				}
			};
			executor.run();
		} catch (FlameMessageExecutionException e) {
			e.printStackTrace();
			Assert.fail();
		}
	}
	
	//@Test
	public void testHornetQTransactionalUnCommitted() {
		try {
			
			boolean isTransactional = true;
			IJmsMessageExecutor<Void> executor = new AbstractJmsMessageExecutor<Void>(
					connectionConf, queueConfig, isTransactional) {

				public Void execute() throws FlameMessageFlowException {
					ObjectMessage objectMsg = createObjectMessage(new AppMessage());
					ITransaction txn = beginTransaction();
					getProducer().send(objectMsg);
					//txn.commit();
					return null;
				}
			};
			executor.run();
		} catch (FlameMessageExecutionException e) {
			e.printStackTrace();
			Assert.fail();
		}
	}
	
	@Test
	public void testHornetQUnStructured() {
		ITransaction txn = null;
		try {
			IMessageConnection conn = connectionConf.getConnection();
			IMessageSession session = conn.createTransactionalSession();
			JMSMessageProducer producer = session.createProducer(queueConfig);
			txn = session.beginTransaction();
			
			ObjectMessage objectMsg = session.createObjectMessage(new AppMessage());
			
			producer.send(objectMsg);
			txn.commit();

			producer.close();
			session.close();
			
		} catch (Exception e) {
			if(txn!=null)
			{
				txn.rollback();
			}
			e.printStackTrace();
			Assert.fail();
		}
	}
	
	@Test
	public void testHornetQWithUserDefineCorrelationIDGenerator() {
		ITransaction txn = null;
		try {
			IMessageConnection conn = connectionConf.getConnection();
			IMessageSession session = conn.createTransactionalSession();
			JMSMessageProducer producer = session.createProducer(queueConfig);
			txn = session.beginTransaction();
			
			ObjectMessage objectMsg = session.createObjectMessage(new AppMessage(), new CorrelationIDGenerator() {
				
				@Override
				public String generate() {
					
					return "Correlation : " + 1;
				}
			});
			
			producer.send(objectMsg);
			txn.commit();

			producer.close();
			session.close();
			
		} catch (Exception e) {
			if(txn!=null)
			{
				txn.rollback();
			}
			e.printStackTrace();
			Assert.fail();
		}
	}
	
	@Test
	public void testActiveMQ() {
		try {
			String connUserName = "admin";
			String connPassword = "admin";
			
			Credential credential = new Credential(connUserName, connPassword);
			JmsTransportConfiguration transportConf2 = new JmsTransportConfiguration(JMSImplementation.ACTIVEMQ,  "localhost", credential);
			IJmsConnectionConfiguration connectionConf2 = transportConf2.createConnectionConfiguration("ConnectionFactory", credential);
			IJmsQueueConfiguration queueConfig2 = transportConf2.createQueueConfiguration("APPANALYZER_QUEUE");
	
			IJmsMessageExecutor<Void> executor2 = new AbstractJmsMessageExecutor<Void>(
					connectionConf2, queueConfig2) {
	
				public Void execute() throws FlameMessageFlowException {
					AppMessage msg = new AppMessage();
					msg.setName("Prabir");
					ObjectMessage objectMsg = createObjectMessage(msg);
					getProducer().send(objectMsg);
					return null;
				}
			};
			executor2.run();
		} catch (FlameMessageExecutionException e) {
			e.printStackTrace();
			Assert.fail();
		} catch(FlameJMSClientException e) {
			e.printStackTrace();
			Assert.fail();
		}
	}
}
</pre>

<p>If you are facing any issues during the implementation, please create a issue through the GitHub.
If you need any technical help from the Author or Contributors, please send email to below mentioned email ids.</p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>You can connect to Author through Email - <a href="mailto:prabir.pk@gmail.com">prabir.pk@gmail.com</a> or <a href="mailto:bigdatasolutions.tech@gmail.com">bigdatasolutions.tech@gmail.com</a>.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/prabirgithub/JMSThinClient">Flame JMS Thin Client</a> is maintained by <a href="https://github.com/prabirgithub">prabirgithub</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
